"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[342],{10403:function(R,E,e){e.d(E,{WY:function(){return C},ul:function(){return A}});var s=e(90228),i=e.n(s),b=e(26068),D=e.n(b),f=e(67825),v=e.n(f),d=e(48305),h=e.n(d),w=e(87999),I=e.n(w),p=e(62850),_=e(33468),a=e(28582),o=e(92435),S=["headers"],A="/api",y=a.Z.create({baseURL:A});function U(P,t){return T.apply(this,arguments)}function T(){return T=I()(i()().mark(function P(t,r){var O,L=arguments;return i()().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return O=L.length>2&&L[2]!==void 0?L[2]:{},B.abrupt("return",new Promise(function(){var K=I()(i()().mark(function m(n,u){var l,g,j,M,z,W,Y,G;return i()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return l=O.headers,g=v()(O,S),j={method:t,url:r,headers:D()({},l)},M=(0,p.K2)("TOKEN"),M&&(j.headers.authorization="Bearer "+M),t==="GET"?j.params=g:j.data=g,c.prev=5,c.next=8,y(j);case 8:if(z=c.sent,W=z.data,Y=W.code,G=W.result,Y!=401){c.next=16;break}return _.H.setState({isLogin:!1,user:{},roles:[],permissions:[]}),(0,p.X8)("TOKEN"),o.m8.push("/login"),c.abrupt("return");case 16:Y&&Y!==200?(console.error(W.message),u(W)):n(G||W),c.next=22;break;case 19:c.prev=19,c.t0=c.catch(5),u(c.t0);case 22:case"end":return c.stop()}},m,null,[[5,19]])}));return function(m,n){return K.apply(this,arguments)}}()));case 2:case"end":return B.stop()}},P)})),T.apply(this,arguments)}var C={get:function(t,r){return U("GET",t,r)},post:function(t,r){return U("POST",t,r)},put:function(t,r){return U("PUT",t,r)},delete:function(t,r){return U("DELETE",t,r)}},N=function(t){if(isArray(t)){var r=_slicedToArray(t,2),O=r[0],L=r[1];return C.get(O,L)}else return C.get(t)},x=function(t){if(isArray(t)){var r=_slicedToArray(t,2),O=r[0],L=r[1];return C.post(O,L)}else return C.post(t)}},74126:function(R,E,e){e.r(E);var s=e(90228),i=e.n(s),b=e(87999),D=e.n(b),f=e(15558),v=e.n(f),d=e(26068),h=e.n(d),w=e(48305),I=e.n(w),p=e(17888),_=e.n(p),a=e(91774),o=e(75271),S=e(44697),A=e(1931),y=e(10403),U=e(69191),T=e(52676),C=function(){var x=(0,o.useState)([]),P=I()(x,2),t=P[0],r=P[1],O=(0,U.U)(function(m){return m}),L=O.selectFlowId,F=O.selectedProjectId;console.log("data",t),(0,o.useEffect)(function(){y.WY.get("/design/schedule/list",{pageNum:1,pageSize:1e3,projectId:F}).then(function(m){console.log("ProgressPage: ",m);var n=m.rows.map(function(u){return h()(h()({},u),{},{startDate:u.plannedStartDate,endDate:u.actualEndDate})});r(n)})},[]);var B=[{name:"id",label:"\u5E8F\u53F7",width:70},{name:"workItem",label:"\u5DE5\u4F5C\u9879",width:150},{name:"plannedStartDate",label:"\u8BA1\u5212\u5F00\u59CB",width:150,render:function(n){return(0,T.jsx)(A.Z,{value:_()(n.startDate),maxDate:_()(n.planEndDate),onChange:function(l){K(n,{startDate:_()(l).format("YYYY-MM-DD")})}})}},{name:"plannedEndDate",label:"\u8BA1\u5212\u7ED3\u675F",width:150,render:function(n){return(0,T.jsx)(A.Z,{value:_()(n.planEndDate),minDate:_()(n.startDate),onChange:function(l){K(n,{planEndDate:_()(l).format("YYYY-MM-DD")})}})}},{name:"actualEndDate",label:"\u5B9E\u9645\u7ED3\u675F",width:150,render:function(n){return(0,T.jsx)(A.Z,{value:_()(n.endDate),minDate:_()(n.startDate),onChange:function(l){K(n,{endDate:_()(l).format("YYYY-MM-DD")})}})}},{name:"plannedDays",label:"\u8BA1\u5212\u5929\u6570",width:90},{name:"actualDays",label:"\u5B9E\u9645\u5929\u6570",width:90}],K=function(n,u){console.log("update",n,u),r(function(l){var g=v()(l),j=g.findIndex(function(M){return M.id===n.id});return g[j]=h()(h()({},n),u),y.WY.put("/design/schedule",h()(h()({},n),u)).then(function(M){}),g})};return(0,T.jsx)("div",{className:"progress-page",children:(0,T.jsx)(S.ZP,{data:t,columns:B,alwaysShowTaskBar:!1,getBarColor:function(n){return{backgroundColor:"#237FFF",borderColor:"#237FFF"}},rowHeight:46,onUpdate:function(){var m=D()(i()().mark(function n(u,l,g){return i()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return console.log("update",u,l,g),K(u,{startDate:_()(l).format("YYYY-MM-DD"),endDate:_()(g).format("YYYY-MM-DD"),plannedStartDate:_()(l).format("YYYY-MM-DD"),actualEndDate:_()(g).format("YYYY-MM-DD"),actualDays:_()(g).diff(_()(l),"day")}),M.abrupt("return",!0);case 3:case"end":return M.stop()}},n)}));return function(n,u,l){return m.apply(this,arguments)}}()})})};E.default=C},62850:function(R,E,e){e.d(E,{K2:function(){return i},X8:function(){return D},v9:function(){return b}});var s="designSphere_";function i(f){return localStorage.getItem(s+f)}function b(f,v){localStorage.setItem(s+f,v)}function D(f){localStorage.removeItem(s+f)}},69191:function(R,E,e){e.d(E,{U:function(){return D}});var s=e(10403),i=e(88701),b=e(31072),D=(0,b.U)(function(f){return{selectedProjectId:null,selectedProject:null,selectFlowId:"",projectList:[],gangweilist:[],getGangweiList:function(){s.WY.get("/system/post/list?pageNum=1&pageSize=10000").then(function(d){console.log("res: ",d),D.setState({gangweilist:d.rows})})},bumenList:[],getBumenList:function(){s.WY.get("/system/user/deptTree?pageNum=1&pageSize=10000").then(function(d){console.log("bumenList: ",d),D.setState({bumenList:(0,i.SI)(d.data)})})},roleList:[],getRoleList:function(){s.WY.get("/system/role/list?pageNum=1&pageSize=10000").then(function(d){console.log("roleList: ",d),D.setState({roleList:d.rows.filter(function(h){return h.roleId>100})})})}}})},33468:function(R,E,e){e.d(E,{H:function(){return b}});var s=e(62850),i=e(31072),b=(0,i.U)(function(D){return{isLogin:(0,s.K2)("TOKEN"),user:{},roles:null,permissions:[]}})},88701:function(R,E,e){e.d(E,{H9:function(){return I},Jn:function(){return f},SI:function(){return v},_:function(){return h},qz:function(){return w}});var s=e(15558),i=e.n(s),b=e(10403),D=e(62850),f=function(_){return"".concat(b.ul).concat(_)},v=function p(_){return _.map(function(a){return{id:a.id,title:a.label,label:a.label,value:a.id,children:a.children?p(a.children):[]}})},d=function p(_){var a=[];return _.forEach(function(o){a.push({id:o.id,label:o.label,value:o.id}),o.children&&a.push.apply(a,i()(p(o.children)))}),a},h=function(_,a){var o;return(o=d(_).find(function(S){return S.id===a}))===null||o===void 0?void 0:o.label},w=function(_){var a=new FormData;return a.append("file",_),fetch(b.ul+"/common/upload",{method:"POST",body:a,headers:{authorization:"Bearer "+(0,D.K2)("TOKEN")}}).then(function(o){return o.json()})},I=function(_){for(var a=["B","KB","MB","GB","TB"],o=0;_>=1024&&o<a.length-1;)_/=1024,o++;return"".concat(_.toFixed(2)).concat(a[o])}},91774:function(){}}]);
